<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="keywords" content="runcode,ode(online development environment),online code editor,online code share,little code,在线代码编辑器,小可代码分享" />
<meta name="description" content="runcode,ode(online development environment),online code editor,online code share,little code,在线代码编辑器,小可代码分享" />
<title>小可&lt;Little Code /&gt;</title>
<link rel="shortcut icon" href="http://www.wanz.im/favicon.ico" />
<link type="text/css" href="style.css" rel="stylesheet" />
<script type="text/javascript" src="ea/edit_area_full.js"></script>
<script type="text/javascript">
//<![CDATA[
editAreaLoader.init({
id: "code"	
	,start_highlight: true	
	,allow_resize: "no"
	,allow_toggle: false
	,word_wrap: true
	,syntax: "html"
	,language: "zh"
	,toolbar: "new_document,fullscreen, | ,search, go_to_line, |, undo, redo, |, select_font, |, syntax_selection, |, highlight, reset_highlight"
	,syntax_selection_allow: "css,html,js,php,python,xml,sql"
	,plugins:"zencoding"
});
//]]>
</script>
<script type="text/javascript">
//<![CDATA[
function runCode(obj)
{
	var code = editAreaLoader.getValue(obj);
	var win = window.open("", "", "");
	win.opener = null;
	win.document.write(code);
	win.document.close();
}
function clipboardini(copyobj){
	ZeroClipboard.setMoviePath( 'scripts/ZeroClipboard.swf' );
	clip = new ZeroClipboard.Client();
	
	clip.setHandCursor( true );
	clip.addEventListener('mousedown', copycode);
	clip.addEventListener('complete', function(){popup('URL已经复制到剪切板了,赶快去分享吧!');});
	clip.glue( copyobj );
}
function copycode(){
	clip.setText( 'http://code.wanz.im/?'+document.getElementsByTagName('em')[0].innerHTML );
}
function saveToUrl(obj){
	popup('<div style="text-align:center;"><img src="images/loading.gif" alt="正在为你保存代码，请骚等片刻..." /><\/div>');
	var xmlHttp=window.ActiveXObject?  new ActiveXObject('Microsoft.XMLHTTP'):new XMLHttpRequest();
	var data='code='+encodeURIComponent(editAreaLoader.getValue(obj));
	xmlHttp.open('POST','op.php?type=save',true);
	xmlHttp.onreadystatechange=savecode;
	xmlHttp.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
	xmlHttp.send(data);
	function savecode(){
		if(xmlHttp.readyState==4&&xmlHttp.status==200){
			popup(xmlHttp.responseText);
			document.getElementById('ctrl_rq_code').disabled=false;
			clipboardini('copyobj');
		}
	}
	setTimeout(function(){//超时请求处理,默认10秒
		if(!(xmlHttp.readyState==4&&xmlHttp.status==200)){
			popup('请求超时,请重新获取!');
			xmlHttp=null;
			document.getElementById('ctrl_rq_code').disabled=false;
		}
	},1000*10);
}
function popup(content){
	var popobj=document.getElementById('popup');
	popobj.getElementsByTagName('div')[0].innerHTML=content;
	popobj.style.display='block';
	popobj.style.left=(document.body.clientWidth-popobj.offsetWidth)/2+'px';
	popobj.style.top='-5px';
	/*setTimeout(function(){closepop(obj)},1000*30);*/
}
function closepop(obj){
	var popobj=document.getElementById(obj);
	popobj.style.opacity=1;
	var t=setInterval(function(){
			popobj.style.opacity-=0.1;
			if(popobj.style.opacity<=0.2){
				popobj.style.display='none';
				popobj.style.opacity=1;
				clearInterval(t);
			}
		},100);
	
	document.getElementById('codekey').focus();
}
function getFromUrl(codekey){
	popup('<div style="text-align:center;"><img src="images/loading.gif" alt="正在为你加载代码，请骚等片刻..." /></\div>');
	var xmlHttp=window.ActiveXObject?  new ActiveXObject('Microsoft.XMLHTTP'):new XMLHttpRequest();
	if(codekey==''){
		popup('请求码不能为空!');
		document.getElementById('ctrl_rq_dump').disabled=false;
		return false;
	}
	var url='op.php?type=get&key='+codekey;
	xmlHttp.open('GET',url,true);
	xmlHttp.onreadystatechange=getcode;
	xmlHttp.send(null);
	function getcode(){
		if(xmlHttp.readyState==4&&xmlHttp.status==200){
			var codes=xmlHttp.responseText;
			if(codes=='404'){
				popup('提取的代码不存在,请确认你的请求码有效或文件已被清理!');
			}else{
				editAreaLoader.setValue('code', codes);
				closepop('popup');
			}
			document.getElementById('ctrl_rq_dump').disabled=false;
		}
	}
	setTimeout(function(){//超时请求处理,默认10秒
		if(!(xmlHttp.readyState==4&&xmlHttp.status==200)){
			popup('请求超时,请重新获取!');
			xmlHttp=null;
			document.getElementById('ctrl_rq_dump').disabled=false;
		}
	},1000*10);
}
function loadlist(num){
	var xmlHttp=window.ActiveXObject?  new ActiveXObject('Microsoft.XMLHTTP'):new XMLHttpRequest();
	var url='op.php?type=list&num='+num;
	xmlHttp.open('GET',url,true);
	xmlHttp.onreadystatechange=getlist;
	xmlHttp.send(null);
	function getlist(){
		if(xmlHttp.readyState==4&&xmlHttp.status==200){
			var list=xmlHttp.responseText;
			if(list){
				document.getElementById('codelist').innerHTML=list;
			}else{
				document.getElementById('codelist').innerHTML=':-(代码列表加载失败';
			}
		}else{
			document.getElementById('codelist').innerHTML=':-(代码列表加载失败';
		}
	}
}
function saveCode(obj,filename)
{
	if(!document.all){popup("您的浏览器不支持此方法。");
		return;
	}
    var winname = window.open("", "", "top=10000,left=10000");
    winname.document.open("text/html", "replace");
    winname.document.write(editAreaLoader.getValue(obj));
    winname.document.execCommand("saveas", "", filename + ".html");
    winname.close();
}
function doins(){
	editAreaLoader.insertTags('code','<script type="text/javascript" src="http://jqueryjs.googlecode.com/files/jquery-1.3.2.min.js"><\/script>', '');
}
var zchelp='<h3>支持Zen Coding快捷键:<\/h3><p>Ctrl+, – 展开缩写<\/p><p>Ctrl+M – 标签匹配<\/p><p>Ctrl+H – 标签围绕<\/p><p>Shift+Ctrl+M – 多行合并<\/p><p>Ctrl+Shift+← – 前一个编辑点<\/p><p>Ctrl+Shift+→ – 下一个编辑点<\/p><p>Ctrl+Shift+↑ – 跳到匹配的标签<\/p><p><em>为什么快捷键无效?很有可能是输入法快捷键冲突!打开你系统的输入法设置修改热键(此热键不影响输入法使用)!<\/em><\/p><a href="javascript:closepop(\'popup\')" class="popup_close">关闭<\/a>';
var usage='<h3>使用说明:<\/h3><dl><dt>快速分享代码:<\/dt><dd>输入代码=&gt;获取URL(点击“分享此代码”按钮)=&gt;分享本页面!<\/dd><dt>快速提取代码:<\/dt><dd><ol><li>访问带请求码的链接(URL在点击"分享此代码"后得到),如:http://code.wanz.im/?1234567890<\/li><li>访问本页面=&gt;输入请求码=&gt;获取对应版本代码!<\/li><\/ol><\/dd><\/dl><p>在分享代码后,你的代码会暂时保存在服务器上,并可通过请求码访问相应的文件,这些文件会在一段时间内(总文件大小超过10M时)清理掉,请自己保存好代码副本.如果请求码失效,请重新编辑分享!<strong>当你对代码进行修改后你需要重新分享新版本的代码<\/strong>,如果要访问旧版本的代码,请使用对应版本的请求码.<\/p><p><em>按下功能键F11,使用全屏模式!<\/em><\/p><a href="javascript:closepop(\'popup\')" class="popup_close">关闭<\/a>';
window.onload=function(){
	/*popup('小可感冒休息中,感谢关注!');*/
	var loca=window.location.href;
	var pattern=new RegExp(/[0-9]{10}$/);
	var requestcode=pattern.exec(loca);
	if(requestcode){
		getFromUrl(requestcode);
	}
	loadlist(20);
}
//]]>
</script>
</head>
<body>
<h1><a href="/">小可&lt;Little Code /&gt;</a></h1>
<div id="coder">
<div id="edit_area">
  <fieldset>
  <legend>代码编辑区</legend>
  <p>[<a href="javascript:popup(usage);">使用说明</a>]&nbsp;[<a href="javascript:popup(zchelp);">Zen Coding快捷键</a>]&nbsp;[<a href="javascript:doins();">光标处插入JQuery1.3.2</a>]</p>
  <textarea id="code" name="code" cols="400" rows="100">
&lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8" /&gt;
&lt;title&gt;无标题文档&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;

&lt;/body&gt;
&lt;/html&gt;
</textarea>
  <div id="ctrl">
    <label>输入请求码:
    <input id="codekey" title="在这里输入请求码可提取相应版本的代码!" />
    </label>
    <button id="ctrl_rq_dump" onclick="this.disabled=true;getFromUrl(document.getElementById('codekey').value);" title="提取请求码对应版本的代码">提取代码</button>
    <button onclick="runCode('code');" title="在新窗口打开并执行代码">运行代码</button>
    <button id="ctrl_rq_code" onclick="this.disabled=true;saveToUrl('code');" title="保存代码到服务器并生成可访问的URL">分享此代码</button>
    <button onclick="saveCode('code','test');" title="在新窗口打开并保存代码到本地,IE only">保存代码(IE only)</button>
  </div>
  </fieldset>
</div>
</div><!--end coder-->
<div id="sider">
	<h2>手气不错</h2>
	<div style="padding:10px 0">看看时间线上最近的20个时间点上别人都分享了什么代码</div>
	<ol id="codelist"><li>添加代码列表</li><li>优化细节</li><li>IE9兼容问题处理</li></ol>
</div>
<div id="stuff">本页面由<a href="http://i.wanz.im/">丸子</a>制作,<a href="http://www.cdolivet.com/index.php?page=editArea">Edit Area</a>驱动，试试可以直接运行页面上代码的<a href="https://chrome.google.com/webstore/detail/eefflcdphpehljcadbmkdpopmbamfefl">Chrome扩展</a></div>
<div id="popup">
  <div>Little Code - Online Code Dumping and Sharing...</div>
</div>
<script type="text/javascript" src="scripts/clipboard.js"></script>
<div style="display:none">
  <script src="http://s94.cnzz.com/stat.php?id=1312001&amp;web_id=1312001" type="text/javascript" charset="gb2312"></script>
</div>
</body>
</html>